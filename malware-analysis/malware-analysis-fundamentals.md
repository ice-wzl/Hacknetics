# Malware Analysis Fundamentals



* Malware: code that is used to perform malicious actions.

#### Malware Analysis Goals

* Assess the nature of malware threats
* Determine the scope of the indicdent
* Eradicate malicious artifacts
* Strengthen your ability to handle malware incidents
* Stages of malware analysis techniques increase in complexity
* Most Complex:
* Manual Code Reversing
* Interactive Behavior analysis
* Static Properties analysis
* Fully automated analysis

### Static Properties Analysis

* **Static properties** are also called metadata
* Entails examinin gthe strings embedded into the file
* Overall file structure
* Header data
* Does not include running the actual file
* Automated and static analysis allow an analyst to justify allocating additional time to taking a closer look at the specimen

### Interaction with other Infosec Professions

&#x20;**Input to REM staff**

* Verbal reports
* Suspicious files
* File system image
* Memory image
* Network Logs
* Anomaly observations
* **Output from REM staff**
* What malware does
* How to identify it
* Attackers profile
* IR recommendations
* Reports and IOCs
* Malware trends

#### What to include in a malware analysis report

* Determine how detailed and formal the output of your malware analysis needs to be
* If a formal report is needed:
* **Summany of the analysis:** Key takeaways the reader should get from the report regarding the specimens nature, origin, caabilities, and other relavant characteristics
* **Identification:** The type of file, its name, size, and hashes, malware name, and current antivirus detection capabilities
* **Characteristics:** The specimens capabilities for infecting files, self-preservation, spreading, leaking data, interacting with the attacker
* **Dependencies:** Files and network resources related to the specimens functionality such as supported OS version and required initialization files, custom DLLs, executables, URLs, and scripts
* **Behavioral and code analysis findings:** Overview of the analysts behavioral, as well as static and dynamic code analysis observations
* **Supporting Figures:** Logs, screenshots, string excerpts, function listings, and other exhibits that support the investigators findings
* **Incident recommendations:** Indicators for detecting the speciment on other systems and networks, and possible for eradication steps

**Templates**

* [https://github.com/MAECProject/schemas/wiki/Malware-Capabilities](https://github.com/MAECProject/schemas/wiki/Malware-Capabilities)
* [https://github.com/MBCProject/mbc-markdown](https://github.com/MBCProject/mbc-markdown) [Malware\_Analysis\_Template.docx](https://github.com/jtaubs1/Reverse-Engineering-Malware/files/8701238/Malware\_Analysis\_Template.docx)

### Open Source Malware Research

* **Malware data repositories:** VT, #totalhash
* **Multi-engine antivirus scanners:** VT, MetaDefender, VirSCAN, AVCaesar
* **File Reputation:** Malware Hash Registry, Hashsets, Windindex
* **Automated sandboxes:** Any.run, CAPE, Intezer Analye, Hybrid Analysis
* **Website investigation:** vURL, Quttera, urlscan.io
* **Other threat intelligence:** Shodan, Open Threat Exchange, RiskIQ Community Edition
